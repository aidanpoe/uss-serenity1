# Security hardening for USS-Serenity website

# Hide sensitive files
<FilesMatch "\.(md|log|sql|conf|ini|bak|old|tmp)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect specific configuration files (not all PHP files)
<Files "config.php">
    Order allow,deny
    Deny from all
</Files>

<Files "secure_config.php">
    Order allow,deny
    Deny from all
</Files>

# Disable directory browsing
Options -Indexes

# Protect against common attacks (simplified)
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Block obvious SQL injection attempts
    RewriteCond %{QUERY_STRING} (union.*select|insert.*into|delete.*from) [NC]
    RewriteRule ^(.*)$ - [F,L]
    
    # Block file injection attempts
    RewriteCond %{QUERY_STRING} \.\./
    RewriteRule ^(.*)$ - [F,L]
</IfModule>

# Security headers (simplified)
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header unset X-Powered-By
</IfModule>

# File upload restrictions
<Files "upload*">
    php_value upload_max_filesize 5M
    php_value post_max_size 10M
</Files>
